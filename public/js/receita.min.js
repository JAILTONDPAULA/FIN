const request=function({url:t,data:e=null,method:a="get",start:s=!0,callback:r=null}){$.ajax({url:t,type:a,data:e,dataType:"json",beforeSend(){s&&$("#load").css({display:"flex"})},success(t){t.success?r?r(t.cod):$("#load").hide():($("#load").hide(),alert("ERROR"))},error(){$("#load").hide(),alert("ERROR")}})};class Util{static contador(){$(this).siblings("small").find("span").text($(this).attr("maxlength")-this.value.length)}static mensagem(t,e){$("#mensagem").find("h6").text(e),$("#mensagem").find("p").text(t),$("#mensagem").css({display:"flex"}),setTimeout(t=>{$("#mensagem").find("div").slideDown(300)},300)}}const buscar=function(){request({url:"http://localhost:84/receitas",start:!0,callback:function(t){$("table tr:not(.cabecalho)").remove();t=t.map((t,e)=>{e=`<tr class="${e%2==0?"":"up"}">`;return(e+=`    <td>${t.origin.description.toUpperCase()}</td>`)+`    <td class="center">${t.value.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}</td>`+`    <td class="center">${t.registrationDate.split("-").reverse().join("/")}</td>`+`    <td class="center">${t.year}/${t.month.toString().padStart(2,"0")}</td>`+`    <td class="center">${t.monthly}</td>`+`    <td class="center link">${t.observation?`<svg data-text='${t.observation}' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20px" height="20px" fill="currentColor"><path d="M12,3C17.5,3 22,6.58 22,11C22,15.42 17.5,19 12,19C10.76,19 9.57,18.82 8.47,18.5C5.55,21 2,21 2,21C4.33,18.67 4.7,17.1 4.75,16.5C3.05,15.07 2,13.13 2,11C2,6.58 6.5,3 12,3M11,14V16H13V14H11M11,12H13V6H11V12Z" /></svg>`:""}</td>`+"</tr>"}).join("");$("table").append(t),$("[data-text]").on({click:mostrarMensagem}),$("#load").hide()}})},mostrarMensagem=function(){var t=$(this).data("text");Util.mensagem(t,"OBSERVAÇÃO")},buscarOrigem=function(){request({url:"http://localhost:84/origem-receitas/descricao",callback:function(t){t=t.map((t,e)=>`<option value="${t}">${t}</option>`).join("");$("#list_origem").html(t)}})},salvar=function(t){t.preventDefault();request({url:"http://localhost:84/receitas",method:"POST",data:$(this).serialize(),start:!0,callback:function(t){$("#origem,#valor,#data,#observacao").val(""),$("#observacao").trigger("paste"),$("#mensal").val("N"),buscar(),buscarOrigem()}})};$(window).on({load:t=>{buscar(),buscarOrigem(),$("#receita").on({submit:salvar}),$("textarea").on("paste input",Util.contador),$("#valor").mask("9.999.990,00",{reverse:!0})}});